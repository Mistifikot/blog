@echo off
echo ===============================================
echo    Docker и API Мониторинг - Установка и запуск
echo ===============================================
echo.

:: Проверка и установка зависимостей бэкенда
echo Проверка и установка зависимостей бэкенда...
cd %~dp0backend
if not exist node_modules (
    echo Установка зависимостей бэкенда...
    call npm install
) else (
    echo Зависимости бэкенда уже установлены.
)

:: Проверка и установка зависимостей фронтенда
echo.
echo Проверка и установка зависимостей фронтенда...
cd %~dp0frontend
if not exist node_modules (
    echo Установка зависимостей фронтенда...
    call npm install
) else (
    echo Зависимости фронтенда уже установлены.
)

echo.
echo ===============================================
echo    Все зависимости установлены!
echo    Запуск приложения...
echo ===============================================
echo.

:: Возвращаемся в корневую директорию
cd %~dp0

:: Запуск бэкенда
echo Запуск бэкенд-сервера...
start cmd /k "cd %~dp0backend && npm start"

:: Ждем 3 секунды, чтобы бэкенд успел инициализироваться
timeout /t 3 /nobreak > nul

:: Запуск фронтенда
echo Запуск фронтенд-приложения...
start cmd /k "cd %~dp0frontend && npm start"

echo.
echo ===============================================
echo    Сервисы запущены!
echo    Бэкенд:  http://localhost:3001
echo    Фронтенд: http://localhost:3000
echo    
echo    API ключи настроены для:
echo    - Anthropic (Claude)
echo    - OpenAI (ChatGPT)
echo    - Perplexity
echo ===============================================

:: Открытие браузера с приложением
echo Открытие браузера через 5 секунд...
timeout /t 5 /nobreak > nul
start http://localhost:3000 